{
  "info": {
    "name": "Nail Booking API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "description": "Multi-tenant nail booking system"
  },
  "variable": [
    { "key": "baseUrl", "value": "http://localhost:3000/api" },
    { "key": "token", "value": "" },
    { "key": "salonId", "value": "" },
    { "key": "bookingId", "value": "" },
    { "key": "superAdminKey", "value": "your-super-admin-secret-key-change-this" }
  ],
  "item": [
    {
      "name": "Super Admin",
      "item": [
        {
          "name": "Create Account (Salon + Owner)",
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "x-super-admin-key", "value": "{{superAdminKey}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"salonName\": \"Pretty Nails\",\n  \"salonSlug\": \"pretty-nails\",\n  \"salonPhone\": \"(555) 111-2222\",\n  \"salonAddress\": \"456 Oak Ave\",\n  \"email\": \"pretty@gmail.com\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/create-account",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "create-account"]
            }
          }
        }
      ]
    },
    {
      "name": "Auth",
      "item": [
        {
          "name": "Login",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const res = pm.response.json();",
                  "if (res.accessToken) {",
                  "  pm.collectionVariables.set('token', res.accessToken);",
                  "  const payload = JSON.parse(atob(res.accessToken.split('.')[1]));",
                  "  pm.collectionVariables.set('salonId', payload.salonId);",
                  "  console.log('salonId:', payload.salonId);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"bella@gmail.com\",\n  \"password\": \"123456\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/login",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "login"]
            }
          }
        },
        {
          "name": "Change Password",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{token}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"currentPassword\": \"123456\",\n  \"newPassword\": \"newpass123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/auth/change-password",
              "host": ["{{baseUrl}}"],
              "path": ["auth", "change-password"]
            }
          }
        }
      ]
    },
    {
      "name": "Bookings - Public",
      "item": [
        {
          "name": "Create Booking (Public)",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "const res = pm.response.json();",
                  "if (res._id) {",
                  "  pm.collectionVariables.set('bookingId', res._id);",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              { "key": "Content-Type", "value": "application/json" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"salonId\": \"{{salonId}}\",\n  \"serviceName\": \"Gel Manicure\",\n  \"customerName\": \"Jane Doe\",\n  \"customerPhone\": \"(555) 987-6543\",\n  \"bookingDate\": \"2026-02-15\",\n  \"bookingTime\": \"10:00\",\n  \"notes\": \"First time customer\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/bookings",
              "host": ["{{baseUrl}}"],
              "path": ["bookings"]
            }
          }
        }
      ]
    },
    {
      "name": "Bookings - Owner",
      "item": [
        {
          "name": "Get All Bookings",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/bookings",
              "host": ["{{baseUrl}}"],
              "path": ["bookings"]
            }
          }
        },
        {
          "name": "Get Today's Bookings",
          "request": {
            "method": "GET",
            "header": [
              { "key": "Authorization", "value": "Bearer {{token}}" }
            ],
            "url": {
              "raw": "{{baseUrl}}/bookings/today",
              "host": ["{{baseUrl}}"],
              "path": ["bookings", "today"]
            }
          }
        },
        {
          "name": "Confirm Booking",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{token}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"confirmed\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/bookings/{{bookingId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["bookings", "{{bookingId}}", "status"]
            }
          }
        },
        {
          "name": "Cancel Booking",
          "request": {
            "method": "PATCH",
            "header": [
              { "key": "Content-Type", "value": "application/json" },
              { "key": "Authorization", "value": "Bearer {{token}}" }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"status\": \"cancelled\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/bookings/{{bookingId}}/status",
              "host": ["{{baseUrl}}"],
              "path": ["bookings", "{{bookingId}}", "status"]
            }
          }
        }
      ]
    }
  ]
}
